using DoubleDouble;
using DoubleDoubleStatistic.DirectionalDistributions;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using static DoubleDoubleStatistic.DirectionalDistributions.VonMisesFisherDistribution;

namespace DoubleDoubleStatisticTest.DirectionalDistributions {
    [TestClass()]
    public class VonMisesFisherDistributionTests {
        readonly VonMisesFisherDistribution dist_kappa0mup100 = new(kappa: 0, mu: (1, 0, 0));
        readonly VonMisesFisherDistribution dist_kappa1mu123 = new(kappa: 1, mu: (1, 2, 3));
        readonly VonMisesFisherDistribution dist_kappa2mu231 = new(kappa: 2, mu: (-2, 3, 1));
        readonly VonMisesFisherDistribution dist_kappa4mu312 = new(kappa: 4, mu: (-3, -1, 2));
        readonly VonMisesFisherDistribution dist_kappa4mu321 = new(kappa: 4, mu: (3, 2, -1));
        readonly VonMisesFisherDistribution dist_kappa1mum123 = new(kappa: 1, mu: (-1, -2, -3));

        VonMisesFisherDistribution[] Dists => [
            dist_kappa0mup100,
            dist_kappa1mu123,
            dist_kappa2mu231,
            dist_kappa4mu312,
            dist_kappa4mu321,
            dist_kappa1mum123
        ];

        [TestMethod()]
        public void InfoTest() {
            foreach (VonMisesFisherDistribution dist in Dists) {
                Console.WriteLine(dist);
                Console.WriteLine($"Kappa={dist.Kappa}");
                Console.WriteLine($"Mu={dist.Mu}");
                Console.WriteLine($"Mean={dist.Mean}");
                Console.WriteLine($"Mode={dist.Mode}");
                Console.WriteLine($"Variance={dist.Variance}");
                Console.WriteLine($"Skewness={dist.Skewness}");
                //Console.WriteLine($"Kurtosis={dist.Kurtosis}");
                Console.WriteLine($"Entropy={dist.Entropy}");
                Console.WriteLine(dist.Formula);
            }
        }

        [TestMethod()]
        public void VarianceTest() {
            Assert.AreEqual(1, (double)dist_kappa0mup100.Variance, 1e-10);
            Assert.AreEqual(0.6869647145006686, (double)dist_kappa1mu123.Variance, 1e-10);
            Assert.AreEqual(0.4626852792724519, (double)dist_kappa2mu231.Variance, 1e-10);
            Assert.AreEqual(0.2493288495983175, (double)dist_kappa4mu312.Variance, 1e-10);
            Assert.AreEqual(0.2493288495983175, (double)dist_kappa4mu321.Variance, 1e-10);
            Assert.AreEqual(0.6869647145006686, (double)dist_kappa1mum123.Variance, 1e-10);
        }

        [TestMethod()]
        public void SkewnessTest() {
            Assert.AreEqual(0, (double)dist_kappa0mup100.Skewness, 1e-10);
            Assert.AreEqual(0, (double)dist_kappa1mu123.Skewness, 1e-10);
            Assert.AreEqual(0, (double)dist_kappa2mu231.Skewness, 1e-10);
            Assert.AreEqual(0, (double)dist_kappa4mu312.Skewness, 1e-10);
            Assert.AreEqual(0, (double)dist_kappa4mu321.Skewness, 1e-10);
            Assert.AreEqual(0, (double)dist_kappa1mum123.Skewness, 1e-10);
        }

        [TestMethod()]
        public void KurtosisTest() {
            Assert.Inconclusive();

            Assert.AreEqual(0, (double)dist_kappa0mup100.Kurtosis, 1e-10);
            Assert.AreEqual(0, (double)dist_kappa1mu123.Kurtosis, 1e-10);
            Assert.AreEqual(0, (double)dist_kappa2mu231.Kurtosis, 1e-10);
            Assert.AreEqual(0, (double)dist_kappa4mu312.Kurtosis, 1e-10);
            Assert.AreEqual(0, (double)dist_kappa4mu321.Kurtosis, 1e-10);
            Assert.AreEqual(0, (double)dist_kappa1mum123.Kurtosis, 1e-10);
        }

        [TestMethod()]
        public void EntropyTest() {
            Assert.AreEqual(2.531024246969288, (double)dist_kappa0mup100.Entropy, 1e-10);
            Assert.AreEqual(2.3794283230411564, (double)dist_kappa1mu123.Entropy, 1e-10);
            Assert.AreEqual(2.0516149975684184, (double)dist_kappa2mu231.Entropy, 1e-10);
            Assert.AreEqual(1.4485625847746588, (double)dist_kappa4mu312.Entropy, 1e-10);
            Assert.AreEqual(1.4485625847746588, (double)dist_kappa4mu321.Entropy, 1e-10);
            Assert.AreEqual(2.3794283230411564, (double)dist_kappa1mum123.Entropy, 1e-10);
        }

        [TestMethod()]
        public void PDFTest() {
            foreach (VonMisesFisherDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (int z = -4; z <= 4; z++) {
                    for (int y = -4; y <= 4; y++) {
                        for (int x = -4; x <= 4; x++) {
                            ddouble pdf = dist.PDF((x, y, z));

                            Console.WriteLine($"pdf({x},{y},{z})={pdf}");
                        }
                    }
                }
            }
        }

        [TestMethod()]
        public void RandomGenerateAndFitTest() {
            Random random = new(1234);

            foreach (VonMisesFisherDistribution dist in Dists) {
                (double, double, double)[] samples = dist.Sample(random, count: 100000).ToArray();

                VonMisesFisherDistribution? dist_fit = VonMisesFisherDistribution.Fit(samples);

                Assert.IsNotNull(dist_fit);

                Console.WriteLine(dist_fit);

                Assert.AreEqual((double)dist.Kappa, (double)dist_fit.Kappa, 0.05, $"{dist},kappa");

                if (dist.Kappa > 0) {
                    Assert.AreEqual((double)dist.Mu.x, (double)dist_fit.Mu.x, 0.05, $"{dist},mu");
                    Assert.AreEqual((double)dist.Mu.y, (double)dist_fit.Mu.y, 0.05, $"{dist},mu");
                    Assert.AreEqual((double)dist.Mu.z, (double)dist_fit.Mu.z, 0.05, $"{dist},mu");
                }
            }
        }

        [TestMethod()]
        public void PDFExpectedTest() {
            ddouble[] expected_dist_kappa0mup100 = [
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                double.NaN,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
                7.957747154594788097e-02,
            ];
            ddouble[] expected_dist_kappa1mu123 = [
                2.682868284652517935e-02,
                2.570348974779353840e-02,
                2.538779958338681711e-02,
                2.632135239480947603e-02,
                2.869998485780141106e-02,
                3.228323074575068646e-02,
                3.652797007648805883e-02,
                2.721061239431836476e-02,
                2.561008156546931702e-02,
                2.491055652470061665e-02,
                2.583338270323202318e-02,
                2.873594601025055914e-02,
                3.319062891670977733e-02,
                3.830148959091408956e-02,
                2.869998485780139719e-02,
                2.675496976972860375e-02,
                2.574663949671257904e-02,
                2.672560221000700939e-02,
                3.024916880008735043e-02,
                3.560316461491298129e-02,
                4.146211832205098924e-02,
                3.179670679199271544e-02,
                2.996162577753373052e-02,
                2.908252317888821228e-02,
                3.037159949780977863e-02,
                3.443826382346332204e-02,
                4.030264698392329453e-02,
                4.640128707034029548e-02,
                3.667709078866529526e-02,
                3.560316461491298129e-02,
                3.553909290620276690e-02,
                3.747536156590413475e-02,
                4.175411010275643237e-02,
                4.737756542079057942e-02,
                5.298643485433333217e-02,
                4.292478356495020575e-02,
                4.301500739349724961e-02,
                4.411148775629045865e-02,
                4.674311686735796445e-02,
                5.088546814840082949e-02,
                5.574738778544501006e-02,
                6.042065967058016240e-02,
                4.973380935402960806e-02,
                5.092684693961692377e-02,
                5.298643485433333217e-02,
                5.605365931112421540e-02,
                5.989923912048543408e-02,
                6.396342158349579976e-02,
                6.771391313789559829e-02,
                2.880610509074518766e-02,
                2.732512086983674912e-02,
                2.675496976972860375e-02,
                2.782103781533052170e-02,
                3.086359656583574987e-02,
                3.541331739129792433e-02,
                4.054729523538136426e-02,
                2.915501181214238263e-02,
                2.682868284652516894e-02,
                2.541485342018691418e-02,
                2.632135239480947603e-02,
                3.037159949780977863e-02,
                3.652797007648805883e-02,
                4.301500739349724961e-02,
                3.086359656583574987e-02,
                2.778290390462195836e-02,
                2.536350080440918572e-02,
                2.602633169358256268e-02,
                3.154859497186397743e-02,
                3.967690127966121832e-02,
                4.737756542079057942e-02,
                3.474957304451894990e-02,
                3.179670679199271544e-02,
                2.933060892405211714e-02,
                3.037159949780977863e-02,
                3.725094694238197113e-02,
                4.640128707034029548e-02,
                5.421279092033452762e-02,
                4.107056440725177088e-02,
                3.967690127966121832e-02,
                3.924197422012407066e-02,
                4.198029018000362655e-02,
                4.881144602687510076e-02,
                5.666277724460935111e-02,
                6.304590419080582930e-02,
                4.896911575431064922e-02,
                4.973380935402960806e-02,
                5.183317708603089186e-02,
                5.605365931112421540e-02,
                6.194237948685379913e-02,
                6.771391313789559829e-02,
                7.224853448172594006e-02,
                5.707412181292744607e-02,
                5.948064263367486282e-02,
                6.304590419080580155e-02,
                6.771391313789559829e-02,
                7.272754814602434836e-02,
                7.708682740173659897e-02,
                8.033718061357739137e-02,
                3.244428994850868248e-02,
                3.086359656583574987e-02,
                3.024916880008735043e-02,
                3.164730013581788792e-02,
                3.553909290620276690e-02,
                4.107056440725177088e-02,
                4.687141806468005795e-02,
                3.314878141262077305e-02,
                3.037159949780977863e-02,
                2.828750278739450286e-02,
                2.933060892405211714e-02,
                3.518563841352068122e-02,
                4.337383014809818860e-02,
                5.088546814840082949e-02,
                3.553909290620278077e-02,
                3.154859497186397743e-02,
                2.682868284652516894e-02,
                2.632135239480947603e-02,
                3.652797007648805883e-02,
                4.881144602687510076e-02,
                5.763483029881049519e-02,
                4.078029983434890149e-02,
                3.725094694238197113e-02,
                3.179670679199271544e-02,
                3.037159949780977863e-02,
                4.640128707034029548e-02,
                6.008551572047739209e-02,
                6.771391313789559829e-02,
                4.905599912396257228e-02,
                4.881144602687510076e-02,
                4.973380935402960806e-02,
                5.605365931112421540e-02,
                6.771391313789559829e-02,
                7.552023363827710389e-02,
                7.955560914596987443e-02,
                5.869969480484516638e-02,
                6.194237948685379913e-02,
                6.771391313789559829e-02,
                7.631080431725113800e-02,
                8.422649680820393225e-02,
                8.846021583504630470e-02,
                9.010773014948801618e-02,
                6.771391313789559829e-02,
                7.272754814602434836e-02,
                7.955560914596987443e-02,
                8.725526881818077007e-02,
                9.346816116944058062e-02,
                9.677943540835402814e-02,
                9.782452124915815006e-02,
                3.841104163839733493e-02,
                3.742325179958717191e-02,
                3.747536156590413475e-02,
                3.967690127966121832e-02,
                4.437669938566940475e-02,
                5.033959496951520562e-02,
                5.605365931112421540e-02,
                4.030264698392329453e-02,
                3.841104163839733493e-02,
                3.725094694238197113e-02,
                3.967690127966121832e-02,
                4.731006613934461008e-02,
                5.605365931112421540e-02,
                6.287613869892171026e-02,
                4.437669938566940475e-02,
                4.198029018000362655e-02,
                3.841104163839733493e-02,
                3.967690127966121832e-02,
                5.605365931112421540e-02,
                6.771391313789559829e-02,
                7.368557807946042593e-02,
                5.183317708603089186e-02,
                5.183317708603089186e-02,
                5.183317708603089186e-02,
                double.NaN,
                8.846021583504630470e-02,
                8.846021583504630470e-02,
                8.846021583504630470e-02,
                6.222620697230533959e-02,
                6.771391313789559829e-02,
                8.179972706146790284e-02,
                1.155628056769865825e-01,
                1.193712494342494407e-01,
                1.092220661835852369e-01,
                1.033239086259570422e-01,
                7.292391243047345595e-02,
                8.179972706146790284e-02,
                9.691751474076439055e-02,
                1.155628056769865825e-01,
                1.230887912604907153e-01,
                1.193712494342494407e-01,
                1.137685580372796157e-01,
                8.179972706146790284e-02,
                9.108484156901087980e-02,
                1.033239086259570422e-01,
                1.155628056769865825e-01,
                1.223516956436293962e-01,
                1.225220634754420196e-01,
                1.193712494342494407e-01,
                4.687141806468005795e-02,
                4.737756542079057942e-02,
                4.905599912396257228e-02,
                5.254896460179249440e-02,
                5.763483029881049519e-02,
                6.304590419080582930e-02,
                6.771391313789559829e-02,
                5.088546814840082949e-02,
                5.183317708603089186e-02,
                5.443861737343276552e-02,
                6.008551572047741984e-02,
                6.771391313789559829e-02,
                7.402321432323395733e-02,
                7.811239986324429452e-02,
                5.763483029881049519e-02,
                6.071451068872877471e-02,
                6.771391313789559829e-02,
                8.179972706146790284e-02,
                9.219430588569951790e-02,
                9.393645150200873040e-02,
                9.346816116944058062e-02,
                6.771391313789559829e-02,
                7.631080431725117963e-02,
                9.881566486497984914e-02,
                1.509691326193447758e-01,
                1.442027962971668964e-01,
                1.230887912604907153e-01,
                1.124360058918550676e-01,
                7.955560914596987443e-02,
                9.393645150200873040e-02,
                1.255250161135509079e-01,
                1.741997889648959630e-01,
                1.709056705719094460e-01,
                1.453368695669544353e-01,
                1.290177564336820737e-01,
                9.010773014948801618e-02,
                1.057129152945584516e-01,
                1.303137938996308809e-01,
                1.563272704061205998e-01,
                1.620918632128149073e-01,
                1.509691326193447758e-01,
                1.383210434004294997e-01,
                9.782452124915815006e-02,
                1.116413689127893211e-01,
                1.290177564336821570e-01,
                1.448835765695236921e-01,
                1.515801661443744730e-01,
                1.485625313519681745e-01,
                1.413245301322191283e-01,
                5.707412181292744607e-02,
                5.948064263367486282e-02,
                6.304590419080582930e-02,
                6.771391313789559829e-02,
                7.272754814602437612e-02,
                7.708682740173659897e-02,
                8.033718061357739137e-02,
                6.346390366722542975e-02,
                6.771391313789559829e-02,
                7.402321432323395733e-02,
                8.179972706146790284e-02,
                8.846021583504630470e-02,
                9.219430588569951790e-02,
                9.363399689411068538e-02,
                7.272754814602434836e-02,
                8.092038998816782069e-02,
                9.393645150200873040e-02,
                1.092220661835852369e-01,
                1.168436125748000820e-01,
                1.155628056769865825e-01,
                1.116413689127893211e-01,
                8.457734705421020294e-02,
                9.881566486497984914e-02,
                1.230887912604907153e-01,
                1.509691326193447758e-01,
                1.563272704061205998e-01,
                1.442027962971668964e-01,
                1.319490753619399770e-01,
                9.677943540835402814e-02,
                1.155628056769865825e-01,
                1.453368695669544353e-01,
                1.761744254407185128e-01,
                1.807784370069838720e-01,
                1.650358093663377435e-01,
                1.485625313519681745e-01,
                1.065947516991390537e-01,
                1.255250161135509079e-01,
                1.509691326193447758e-01,
                1.741997889648959630e-01,
                1.804131606285199196e-01,
                1.709056705719094460e-01,
                1.572688106590597046e-01,
                1.130821181987367169e-01,
                1.294759816422388909e-01,
                1.485625313519681745e-01,
                1.648095970711722646e-01,
                1.713765357206374351e-01,
                1.678006861996312049e-01,
                1.591736896745402363e-01,
                6.771391313789559829e-02,
                7.168431454938867242e-02,
                7.654811813591716474e-02,
                8.179972706146790284e-02,
                8.653486585862429914e-02,
                9.003451633051287595e-02,
                9.219430588569951790e-02,
                7.588752021982753115e-02,
                8.224912797875714998e-02,
                9.010773014948801618e-02,
                9.809303143942516012e-02,
                1.039451232699039329e-01,
                1.065947516991390537e-01,
                1.068188037688895115e-01,
                8.653486585862429914e-02,
                9.677943540835402814e-02,
                1.098137170487505088e-01,
                1.223516956436293962e-01,
                1.290177564336821570e-01,
                1.287855751599646381e-01,
                1.250146599376271705e-01,
                9.881566486497984914e-02,
                1.137685580372796157e-01,
                1.331418464052336881e-01,
                1.509691326193447758e-01,
                1.576608055718828061e-01,
                1.530348875755798421e-01,
                1.442027962971669242e-01,
                1.105870664116048174e-01,
                1.287855751599646381e-01,
                1.515801661443744730e-01,
                1.715648536716459227e-01,
                1.780882523729716560e-01,
                1.713765357206374351e-01,
                1.597622457002830509e-01,
                1.197126817107961316e-01,
                1.381466450651699096e-01,
                1.595623137241024281e-01,
                1.774902685072217434e-01,
                1.840654996165957957e-01,
                1.790378535392393722e-01,
                1.685068298354014116e-01,
                1.255250161135509079e-01,
                1.420295901781762349e-01,
                1.597622457002829954e-01,
                1.741997889648959630e-01,
                1.806054131389512041e-01,
                1.783872181340696583e-01,
                1.709056705719094182e-01,
            ];
            ddouble[] expected_dist_kappa2mu231 = [
                2.367210711633462722e-02,
                1.763395365114951360e-02,
                1.287428821807653882e-02,
                9.676042140754738743e-03,
                7.883095757928393343e-03,
                7.086146045106803473e-03,
                6.888619075027103793e-03,
                3.117539340023142008e-02,
                2.294975168004622507e-02,
                1.614339261517802604e-02,
                1.155666203174875867e-02,
                9.116466360477266245e-03,
                8.135044075972376956e-03,
                7.941500149069750242e-03,
                4.388229079551837081e-02,
                3.297654510095868879e-02,
                2.303126104000258537e-02,
                1.591601339681671112e-02,
                1.208776878956634333e-02,
                1.051643647058537329e-02,
                1.007418715521340470e-02,
                6.403791392068845789e-02,
                5.089479725439677998e-02,
                3.705784199068349466e-02,
                2.571278544002454300e-02,
                1.884705343500751862e-02,
                1.554535370131103142e-02,
                1.412035567126519557e-02,
                9.158596572572519356e-02,
                7.770653904199557871e-02,
                6.057244129736081423e-02,
                4.388229079551837081e-02,
                3.179094988113577436e-02,
                2.478112484744350932e-02,
                2.102566075712129778e-02,
                1.223830681125202408e-01,
                1.087439518154035833e-01,
                8.963954331329614111e-02,
                6.846073915656337994e-02,
                5.062107455751778395e-02,
                3.854668465902731656e-02,
                3.117539340023140620e-02,
                1.507974641808116911e-01,
                1.371556763680197855e-01,
                1.170421098315290592e-01,
                9.345123841466176917e-02,
                7.166642099999244453e-02,
                5.511555564261315376e-02,
                4.388229079551837081e-02,
                2.482144401708470324e-02,
                1.770816135807992686e-02,
                1.213139298350554562e-02,
                8.591405501748071785e-03,
                6.850817462983354277e-03,
                6.277047140238203871e-03,
                6.322919452247915961e-03,
                3.385982981440521095e-02,
                2.367210711633461681e-02,
                1.506638151972367230e-02,
                9.676042140754738743e-03,
                7.387351102573733695e-03,
                6.888619075027097721e-03,
                7.145911778968038093e-03,
                5.062107455751778395e-02,
                3.672055495103385830e-02,
                2.280220334547425690e-02,
                1.328030659326757956e-02,
                9.525625692024293142e-03,
                8.828131538970836190e-03,
                9.116466360477266245e-03,
                7.940094685337806268e-02,
                6.403791392068845789e-02,
                4.388229079551837081e-02,
                2.571278544002454300e-02,
                1.686647548182001327e-02,
                1.412035567126519557e-02,
                1.340344727635567508e-02,
                1.192844336606132122e-01,
                1.069521615674334930e-01,
                8.445041105401059067e-02,
                5.573211556455468646e-02,
                3.527917864120615199e-02,
                2.571278544002454300e-02,
                2.148220946119886940e-02,
                1.604397186143335929e-01,
                1.507974641808117189e-01,
                1.278114086611657207e-01,
                9.345123841466176917e-02,
                6.266851463030534419e-02,
                4.388229079551837081e-02,
                3.385982981440521095e-02,
                1.930594811545432998e-01,
                1.826476764386663620e-01,
                1.587332508377772566e-01,
                1.238733760879325851e-01,
                8.963954331329614111e-02,
                6.474348476259850216e-02,
                4.917923179621376539e-02,
                2.686970297376283651e-02,
                1.862245261971755966e-02,
                1.208776878956634333e-02,
                8.094641750523786858e-03,
                6.344166481211381547e-03,
                5.938822253882880715e-03,
                6.168557102545936012e-03,
                3.804058808104569811e-02,
                2.571278544002454300e-02,
                1.473788499149086828e-02,
                8.233331949513067113e-03,
                6.156754844873728663e-03,
                6.181710826553831438e-03,
                6.850817462983354277e-03,
                6.057244129736081423e-02,
                4.388229079551837081e-02,
                2.367210711633461681e-02,
                9.676042140754738743e-03,
                6.888619075027097721e-03,
                7.658129153378404226e-03,
                8.757100980769823295e-03,
                1.021727588401496051e-01,
                8.989551087302873056e-02,
                6.403791392068845789e-02,
                2.571278544002454300e-02,
                1.412035567126519557e-02,
                1.328030659326757956e-02,
                1.344080035222482150e-02,
                1.593061117387174763e-01,
                1.625227807824408399e-01,
                1.507974641808117189e-01,
                9.345123841466176917e-02,
                4.388229079551837081e-02,
                2.836270447679655263e-02,
                2.303126104000259577e-02,
                2.112282730303000067e-01,
                2.181271809285846019e-01,
                2.021552712358589410e-01,
                1.450008274988653367e-01,
                8.445041105401059067e-02,
                5.244080455838045357e-02,
                3.804058808104569811e-02,
                2.442765513187779569e-01,
                2.436655416999004287e-01,
                2.198964531402668454e-01,
                1.696534195497414466e-01,
                1.154108530396368987e-01,
                7.770653904199557871e-02,
                5.607928964061253962e-02,
                3.007055238943882880e-02,
                2.091071115820256759e-02,
                1.344080035222482150e-02,
                8.828131538970836190e-03,
                6.835786134317662840e-03,
                6.386986855952707029e-03,
                6.630554760046825265e-03,
                4.388229079551837081e-02,
                3.007055238943882880e-02,
                1.686647548182001327e-02,
                8.828131538970836190e-03,
                6.482751698274807906e-03,
                6.630554760046825265e-03,
                7.407644295849035061e-03,
                7.286463413191450467e-02,
                5.573211556455468646e-02,
                3.007055238943882880e-02,
                8.828131538970836190e-03,
                6.630554760046825265e-03,
                8.233331949513067113e-03,
                9.585324025919536584e-03,
                1.278114086611657207e-01,
                1.278114086611657207e-01,
                1.278114086611657207e-01,
                double.NaN,
                1.506638151972367230e-02,
                1.506638151972367230e-02,
                1.506638151972367230e-02,
                2.008962284691991895e-01,
                2.338853160871672276e-01,
                2.904214677579764481e-01,
                2.181271809285846297e-01,
                6.403791392068845789e-02,
                3.455198902743864681e-02,
                2.642784758894445307e-02,
                2.599551717867313871e-01,
                2.904214677579764481e-01,
                2.970429124988534508e-01,
                2.181271809285846297e-01,
                1.141705893171372360e-01,
                6.403791392068845789e-02,
                4.388229079551837081e-02,
                2.904214677579764481e-01,
                3.014966977218239697e-01,
                2.817021199354202143e-01,
                2.181271809285846297e-01,
                1.432694032348815483e-01,
                9.208942875704477504e-02,
                6.403791392068845789e-02,
                3.433808555356378245e-02,
                2.478112484744351973e-02,
                1.668521975832797100e-02,
                1.135052538624394848e-02,
                8.757100980769823295e-03,
                7.902863211713710354e-03,
                7.883095757928393343e-03,
                5.062107455751778395e-02,
                3.672055495103385830e-02,
                2.280220334547425690e-02,
                1.328030659326757956e-02,
                9.525625692024284469e-03,
                8.828131538970836190e-03,
                9.116466360477266245e-03,
                8.361050843537394528e-02,
                6.789392905171681702e-02,
                4.388229079551837081e-02,
                2.060599172498837894e-02,
                1.276981317904327985e-02,
                1.184852631853617992e-02,
                1.208776878956633292e-02,
                1.432694032348815483e-01,
                1.450008274988653090e-01,
                1.363744292490541854e-01,
                7.489097009556029694e-02,
                3.007055238943882880e-02,
                2.142104123733490351e-02,
                1.884705343500751862e-02,
                2.198964531402667899e-01,
                2.514524640281013412e-01,
                2.795415778531578632e-01,
                1.990127179533173196e-01,
                8.134702314411478008e-02,
                4.388229079551837081e-02,
                3.179094988113577436e-02,
                2.810840393671593107e-01,
                3.115084965137309703e-01,
                3.127711747473243542e-01,
                2.338853160871672276e-01,
                1.306602301873193983e-01,
                7.489097009556029694e-02,
                5.062107455751778395e-02,
                3.121727518203025187e-01,
                3.242487084376733386e-01,
                3.035316697891483617e-01,
                2.378926090630054113e-01,
                1.593061117387174486e-01,
                1.034050393246022520e-01,
                7.166642099999244453e-02,
                3.915586671711065309e-02,
                2.974284520710357774e-02,
                2.148220946119886940e-02,
                1.554535370131103142e-02,
                1.213139298350554562e-02,
                1.054300543543502597e-02,
                9.974415314630198995e-03,
                5.687138582850147922e-02,
                4.388229079551837081e-02,
                3.072763822187712587e-02,
                2.060599172498837894e-02,
                1.506638151972367230e-02,
                1.276981317904327985e-02,
                1.200236114905775878e-02,
                8.963954331329614111e-02,
                7.489097009556029694e-02,
                5.458334121229417579e-02,
                3.455198902743864681e-02,
                2.280220334547425690e-02,
                1.800482961018331357e-02,
                1.614339261517802604e-02,
                1.436686701382699771e-01,
                1.363744292490541854e-01,
                1.141705893171371805e-01,
                7.489097009556029694e-02,
                4.388229079551837081e-02,
                3.007055238943882880e-02,
                2.425229826312216494e-02,
                2.112282730303000067e-01,
                2.181271809285846297e-01,
                2.021552712358589132e-01,
                1.450008274988653367e-01,
                8.445041105401059067e-02,
                5.244080455838045357e-02,
                3.804058808104569811e-02,
                2.694765209850555898e-01,
                2.795415778531578632e-01,
                2.606692735629613233e-01,
                1.990127179533173196e-01,
                1.278114086611657207e-01,
                8.134702314411478008e-02,
                5.687138582850147922e-02,
                3.045516331507006069e-01,
                3.067772795775690065e-01,
                2.810840393671593662e-01,
                2.241374179196439775e-01,
                1.587332508377772566e-01,
                1.087439518154035833e-01,
                7.758031499444591195e-02,
                4.388229079551837081e-02,
                3.493851097045996834e-02,
                2.686970297376283651e-02,
                2.060599172498837894e-02,
                1.645267201893603481e-02,
                1.403992526197360251e-02,
                1.276981317904327985e-02,
                6.176844092200430014e-02,
                4.995644794088572455e-02,
                3.804058808104569811e-02,
                2.812787985035686625e-02,
                2.148220946119886940e-02,
                1.770816135807992686e-02,
                1.573465574250818011e-02,
                9.158596572572519356e-02,
                7.770653904199560646e-02,
                6.057244129736081423e-02,
                4.388229079551837081e-02,
                3.179094988113577436e-02,
                2.478112484744351973e-02,
                2.102566075712129778e-02,
                1.363744292490542132e-01,
                1.238733760879325851e-01,
                1.021727588401496051e-01,
                7.489097009556029694e-02,
                5.196350737170703921e-02,
                3.783599796727905862e-02,
                3.007055238943882880e-02,
                1.911474758006563024e-01,
                1.831091216923643739e-01,
                1.593061117387174486e-01,
                1.209885539457749987e-01,
                8.361050843537398691e-02,
                5.839469961352786176e-02,
                4.388229079551837081e-02,
                2.424800616150594723e-01,
                2.367111262679009731e-01,
                2.112282730303000067e-01,
                1.666273046812501712e-01,
                1.192844336606132122e-01,
                8.390746324007970769e-02,
                6.176844092200427239e-02,
                2.795415778531578077e-01,
                2.717493307652272816e-01,
                2.442765513187779569e-01,
                1.990127179533173751e-01,
                1.495737405318191271e-01,
                1.092015712163850322e-01,
                8.134702314411473845e-02,
            ];
            ddouble[] expected_dist_kappa4mu312 = [
                4.008230208178664017e-02,
                2.311014159707431431e-02,
                1.166401069979388326e-02,
                5.477118527838457408e-03,
                2.677741399547352210e-03,
                1.499628958226885455e-03,
                9.877303863421512276e-04,
                3.645628447586498483e-02,
                1.959101556185420534e-02,
                8.765239187082279546e-03,
                3.562666160115377043e-03,
                1.578552191731486150e-03,
                8.725748840405469142e-04,
                6.026209448936802266e-04,
                3.111005366066325536e-02,
                1.552144130937211861e-02,
                6.121760517292130534e-03,
                2.151573818902596715e-03,
                8.850373846885486789e-04,
                5.034106450212961744e-04,
                3.764115416382512840e-04,
                2.483954745792180813e-02,
                1.166401069979388326e-02,
                4.230511835026910632e-03,
                1.374951086871393667e-03,
                5.565227523246323287e-04,
                3.323759313314822461e-04,
                2.662987080941481939e-04,
                1.904909443435929065e-02,
                8.765239187082279546e-03,
                3.212955885897726682e-03,
                1.094257640377846409e-03,
                4.645046251551867016e-04,
                2.842851140551414229e-04,
                2.304817304740368539e-04,
                1.464983753323515631e-02,
                6.944466210818002645e-03,
                2.795292253273566185e-03,
                1.088184029928533679e-03,
                5.034106450212961744e-04,
                3.093033528300920504e-04,
                2.421612367728158324e-04,
                1.166401069979388326e-02,
                5.886988837062319749e-03,
                2.677741399547352210e-03,
                1.207704263485852476e-03,
                6.147370049117427447e-04,
                3.820097293533983090e-04,
                2.874310405449861439e-04,
                7.223157780156622132e-02,
                4.264523480120201160e-02,
                2.065457127234464341e-02,
                8.671210200952262151e-03,
                3.719729496861220747e-03,
                1.899399277901388499e-03,
                1.193985132927028380e-03,
                7.162745989628067911e-02,
                4.008230208178664017e-02,
                1.665743086645611951e-02,
                5.477118527838457408e-03,
                1.963574388243974345e-03,
                9.877303863421503603e-04,
                6.732838358783835428e-04,
                6.476684407389625420e-02,
                3.397255729256091344e-02,
                1.166401069979388326e-02,
                2.779396343226791556e-03,
                8.503505606466146794e-04,
                4.720705612724933244e-04,
                3.783016688258873553e-04,
                5.136755389300717151e-02,
                2.483954745792180813e-02,
                7.231284253840892899e-03,
                1.374951086871393667e-03,
                4.106015442127382092e-04,
                2.662987080941481939e-04,
                2.470935290177233320e-04,
                3.657501055378007543e-02,
                1.665743086645611951e-02,
                4.872643152533553783e-03,
                1.068281063441713389e-03,
                3.552341422887253519e-04,
                2.314657289637595070e-04,
                2.136338079717564143e-04,
                2.538992802317822234e-02,
                1.166401069979388326e-02,
                4.004677788407099912e-03,
                1.207704263485852476e-03,
                4.720705612724937581e-04,
                2.874310405449861439e-04,
                2.386602590246141985e-04,
                1.839999510236888652e-02,
                9.000018232611432106e-03,
                3.719729496861220747e-03,
                1.463762251667863811e-03,
                6.698946856546767869e-04,
                4.008567009142054182e-04,
                3.041511935197161571e-04,
                1.355127118811687570e-01,
                8.618602939930435081e-02,
                4.234391956704162963e-02,
                1.635559097409898521e-02,
                6.121760517292130534e-03,
                2.795292253273566185e-03,
                1.639616226546985588e-03,
                1.526177858307160573e-01,
                9.894835307521857026e-02,
                4.319891736828486428e-02,
                1.166401069979388326e-02,
                3.149364703866137233e-03,
                1.374951086871393667e-03,
                8.914370292058373165e-04,
                1.537213545536076920e-01,
                1.034084825483671116e-01,
                4.008230208178664017e-02,
                5.477118527838457408e-03,
                9.877303863421503603e-04,
                5.496121833220554481e-04,
                4.645046251551867016e-04,
                1.243300851506309451e-01,
                7.895466820156098187e-02,
                2.483954745792180813e-02,
                1.374951086871393667e-03,
                2.662987080941481939e-04,
                2.545587926561826051e-04,
                2.830389868221882513e-04,
                8.067939435168469675e-02,
                4.319891736828486428e-02,
                1.166401069979388326e-02,
                1.207704263485852476e-03,
                2.874310405449861439e-04,
                2.296006159922805642e-04,
                2.437914494046934286e-04,
                4.867081266568067111e-02,
                2.378855868810788449e-02,
                7.538870065694773005e-03,
                1.723129850379341490e-03,
                5.496121833220558818e-04,
                3.305573423587335256e-04,
                2.842851140551408808e-04,
                3.111005366066325536e-02,
                1.552144130937211861e-02,
                6.121760517292130534e-03,
                2.151573818902596715e-03,
                8.850373846885495463e-04,
                5.034106450212961744e-04,
                3.764115416382509045e-04,
                2.399004094686066901e-01,
                1.681750889089398404e-01,
                8.866615983487163843e-02,
                3.397255729256089263e-02,
                1.166401069979388326e-02,
                4.792292569129026972e-03,
                2.571913567305063059e-03,
                3.042972701389739520e-01,
                2.399004094686065791e-01,
                1.273533251320514148e-01,
                3.397255729256089263e-02,
                7.231284253840892899e-03,
                2.571913567305063059e-03,
                1.463762251667863811e-03,
                3.427924327019449824e-01,
                3.313410471111557509e-01,
                2.399004094686065791e-01,
                3.397255729256089263e-02,
                2.571913567305063059e-03,
                1.068281063441713389e-03,
                7.803712409970886858e-04,
                2.881966315335949824e-01,
                2.881966315335949824e-01,
                2.881966315335949824e-01,
                double.NaN,
                4.720705612724933244e-04,
                4.720705612724933244e-04,
                4.720705612724933244e-04,
                1.743390048960218874e-01,
                1.273533251320514148e-01,
                5.289802399831929069e-02,
                4.004677788407099912e-03,
                5.671067669549334283e-04,
                4.106015442127382092e-04,
                3.968849152606580247e-04,
                9.294483817292514827e-02,
                5.289802399831929069e-02,
                1.881396731606059525e-02,
                4.004677788407099912e-03,
                1.068281063441713389e-03,
                5.671067669549334283e-04,
                4.470928889462986869e-04,
                5.289802399831926988e-02,
                2.838915688939926130e-02,
                1.166401069979388326e-02,
                4.004677788407099912e-03,
                1.534397631049757432e-03,
                8.089732343092225723e-04,
                5.671067669549329946e-04,
                3.614372317405073476e-01,
                2.702548048008615589e-01,
                1.537213545536076920e-01,
                6.323238571210058889e-02,
                2.222385949607278907e-02,
                8.765239187082279546e-03,
                4.373156892909251317e-03,
                4.785658442127138090e-01,
                4.115750224578597627e-01,
                2.475366262490319713e-01,
                7.895466820156094023e-02,
                1.804635766624903062e-02,
                5.719099983679061874e-03,
                2.795292253273566185e-03,
                5.580554442623819611e-01,
                5.925469538351769705e-01,
                4.733279514521087639e-01,
                1.126510435694093454e-01,
                1.166401069979388326e-02,
                3.149364703866137233e-03,
                1.686293590800428495e-03,
                4.806728116588953048e-01,
                5.344507812333143537e-01,
                5.108892438066462427e-01,
                9.894835307521857026e-02,
                5.477118527838457408e-03,
                1.723129850379339972e-03,
                1.094257640377846409e-03,
                2.928908308705288621e-01,
                2.475366262490321934e-01,
                1.377391517828415735e-01,
                2.483954745792180813e-02,
                3.394244804784473258e-03,
                1.315647829386453914e-03,
                8.850373846885495463e-04,
                1.526177858307160573e-01,
                9.894835307521857026e-02,
                4.319891736828486428e-02,
                1.166401069979388326e-02,
                3.149364703866137233e-03,
                1.374951086871393667e-03,
                8.914370292058373165e-04,
                8.297621321510355308e-02,
                4.867081266568069192e-02,
                2.222385949607278907e-02,
                8.318204204321087009e-03,
                3.212955885897723646e-03,
                1.578552191731486150e-03,
                1.003958549100602334e-03,
                4.473076170785669770e-01,
                3.393959619350969126e-01,
                2.030903491523412541e-01,
                9.294483817292514827e-02,
                3.657501055378007543e-02,
                1.511654111009843801e-02,
                7.393977272710834311e-03,
                5.700536241807853122e-01,
                4.733279514521087639e-01,
                2.881966315335948714e-01,
                1.126510435694093454e-01,
                3.397255729256089263e-02,
                1.166401069979388326e-02,
                5.358390361749281773e-03,
                6.368334061755461795e-01,
                5.877723074339321618e-01,
                3.829844302925389243e-01,
                1.273533251320513593e-01,
                2.792101562663516778e-02,
                8.167474726182113662e-03,
                3.719729496861220747e-03,
                5.505977681639238064e-01,
                5.108892438066462427e-01,
                3.313410471111557509e-01,
                9.894835307521857026e-02,
                1.881396731606059525e-02,
                5.477118527838457408e-03,
                2.648542422095496833e-03,
                3.596313651672590206e-01,
                2.881966315335949824e-01,
                1.599918338402142315e-01,
                4.894917054073597007e-02,
                1.166401069979388326e-02,
                4.004677788407096442e-03,
                2.100598655844336266e-03,
                2.020680407801754841e-01,
                1.377391517828415735e-01,
                6.928647390159485553e-02,
                2.483954745792180813e-02,
                8.167474726182113662e-03,
                3.394244804784473258e-03,
                1.899399277901388499e-03,
                1.139454268340718002e-01,
                7.162745989628067911e-02,
                3.657501055378007543e-02,
                1.568975292398809909e-02,
                6.586878217466013083e-03,
                3.190254344691085143e-03,
                1.883513412633168157e-03,
                4.733279514521083753e-01,
                3.561405250991571680e-01,
                2.213127638614153514e-01,
                1.126510435694094009e-01,
                5.080742510382222493e-02,
                2.311014159707433513e-02,
                1.166401069979388326e-02,
                5.618122347654717075e-01,
                4.398566790824325334e-01,
                2.702548048008615589e-01,
                1.250240233849427562e-01,
                4.867081266568069192e-02,
                1.959101556185420534e-02,
                9.286734088092113079e-03,
                5.902816909830159720e-01,
                4.785658442127135870e-01,
                2.928908308705286956e-01,
                1.243300851506309451e-01,
                4.234391956704160881e-02,
                1.552144130937211861e-02,
                7.142026938535787385e-03,
                5.108892438066462427e-01,
                4.093230970723416018e-01,
                2.444628634438033576e-01,
                9.894835307521857026e-02,
                3.215902730219895311e-02,
                1.166401069979388326e-02,
                5.477118527838457408e-03,
                3.614372317405071811e-01,
                2.702548048008615589e-01,
                1.537213545536077475e-01,
                6.323238571210056114e-02,
                2.222385949607279948e-02,
                8.765239187082279546e-03,
                4.373156892909251317e-03,
                2.257623913634618229e-01,
                1.559168709680443243e-01,
                8.618602939930435081e-02,
                3.818745273637994680e-02,
                1.552144130937211861e-02,
                6.944466210818002645e-03,
                3.731843427296445501e-03,
                1.377391517828414347e-01,
                9.072187147263839624e-02,
                5.080742510382222493e-02,
                2.483954745792180813e-02,
                1.166401069979388326e-02,
                5.886988837062324953e-03,
                3.394244804784473258e-03,
            ];
            ddouble[] expected_dist_kappa4mu321 = [
                9.877303863421503603e-04,
                1.499628958226885455e-03,
                2.677741399547352210e-03,
                5.477118527838457408e-03,
                1.166401069979388326e-02,
                2.311014159707432472e-02,
                4.008230208178662629e-02,
                1.193985132927028380e-03,
                1.899399277901388499e-03,
                3.719729496861224217e-03,
                8.671210200952262151e-03,
                2.065457127234464341e-02,
                4.264523480120201160e-02,
                7.223157780156622132e-02,
                1.639616226546984070e-03,
                2.795292253273566185e-03,
                6.121760517292130534e-03,
                1.635559097409898521e-02,
                4.234391956704162963e-02,
                8.618602939930435081e-02,
                1.355127118811688125e-01,
                2.571913567305063059e-03,
                4.792292569129026972e-03,
                1.166401069979388326e-02,
                3.397255729256089263e-02,
                8.866615983487163843e-02,
                1.681750889089398404e-01,
                2.399004094686066901e-01,
                4.373156892909251317e-03,
                8.765239187082279546e-03,
                2.222385949607278907e-02,
                6.323238571210058889e-02,
                1.537213545536076920e-01,
                2.702548048008615589e-01,
                3.614372317405073476e-01,
                7.393977272710834311e-03,
                1.511654111009843801e-02,
                3.657501055378007543e-02,
                9.294483817292514827e-02,
                2.030903491523411708e-01,
                3.393959619350972456e-01,
                4.473076170785671435e-01,
                1.166401069979388326e-02,
                2.311014159707433513e-02,
                5.080742510382222493e-02,
                1.126510435694094009e-01,
                2.213127638614153514e-01,
                3.561405250991570015e-01,
                4.733279514521085973e-01,
                6.026209448936807687e-04,
                8.725748840405469142e-04,
                1.578552191731486150e-03,
                3.562666160115377043e-03,
                8.765239187082279546e-03,
                1.959101556185420534e-02,
                3.645628447586498483e-02,
                6.732838358783835428e-04,
                9.877303863421503603e-04,
                1.963574388243974345e-03,
                5.477118527838457408e-03,
                1.665743086645611951e-02,
                4.008230208178664017e-02,
                7.162745989628067911e-02,
                8.914370292058373165e-04,
                1.374951086871393667e-03,
                3.149364703866137233e-03,
                1.166401069979388326e-02,
                4.319891736828486428e-02,
                9.894835307521857026e-02,
                1.526177858307160573e-01,
                1.463762251667863811e-03,
                2.571913567305063059e-03,
                7.231284253840892899e-03,
                3.397255729256089263e-02,
                1.273533251320514148e-01,
                2.399004094686065791e-01,
                3.042972701389739520e-01,
                2.795292253273566185e-03,
                5.719099983679061874e-03,
                1.804635766624903062e-02,
                7.895466820156094023e-02,
                2.475366262490319713e-01,
                4.115750224578597627e-01,
                4.785658442127138090e-01,
                5.358390361749281773e-03,
                1.166401069979388326e-02,
                3.397255729256089263e-02,
                1.126510435694093454e-01,
                2.881966315335949824e-01,
                4.733279514521087639e-01,
                5.700536241807853122e-01,
                9.286734088092113079e-03,
                1.959101556185420534e-02,
                4.867081266568069192e-02,
                1.250240233849427562e-01,
                2.702548048008615589e-01,
                4.398566790824325334e-01,
                5.618122347654714854e-01,
                3.764115416382509045e-04,
                5.034106450212961744e-04,
                8.850373846885486789e-04,
                2.151573818902596715e-03,
                6.121760517292130534e-03,
                1.552144130937211861e-02,
                3.111005366066324149e-02,
                3.783016688258873553e-04,
                4.720705612724937581e-04,
                8.503505606466146794e-04,
                2.779396343226791556e-03,
                1.166401069979388326e-02,
                3.397255729256089263e-02,
                6.476684407389625420e-02,
                4.645046251551867016e-04,
                5.496121833220554481e-04,
                9.877303863421503603e-04,
                5.477118527838457408e-03,
                4.008230208178664017e-02,
                1.034084825483671671e-01,
                1.537213545536076920e-01,
                7.803712409970886858e-04,
                1.068281063441713389e-03,
                2.571913567305063059e-03,
                3.397255729256089263e-02,
                2.399004094686065791e-01,
                3.313410471111557509e-01,
                3.427924327019449824e-01,
                1.686293590800428495e-03,
                3.149364703866137233e-03,
                1.166401069979388326e-02,
                1.126510435694093454e-01,
                4.733279514521087639e-01,
                5.925469538351767484e-01,
                5.580554442623819611e-01,
                3.719729496861224217e-03,
                8.167474726182113662e-03,
                2.792101562663516778e-02,
                1.273533251320513593e-01,
                3.829844302925389243e-01,
                5.877723074339321618e-01,
                6.368334061755461795e-01,
                7.142026938535787385e-03,
                1.552144130937211861e-02,
                4.234391956704160881e-02,
                1.243300851506309451e-01,
                2.928908308705286956e-01,
                4.785658442127135870e-01,
                5.902816909830161940e-01,
                2.662987080941481939e-04,
                3.323759313314822461e-04,
                5.565227523246323287e-04,
                1.374951086871393667e-03,
                4.230511835026910632e-03,
                1.166401069979388326e-02,
                2.483954745792180813e-02,
                2.470935290177233320e-04,
                2.662987080941481939e-04,
                4.106015442127382092e-04,
                1.374951086871393667e-03,
                7.231284253840892899e-03,
                2.483954745792180813e-02,
                5.136755389300717151e-02,
                2.830389868221882513e-04,
                2.545587926561826051e-04,
                2.662987080941481939e-04,
                1.374951086871393667e-03,
                2.483954745792180813e-02,
                7.895466820156098187e-02,
                1.243300851506309451e-01,
                4.720705612724933244e-04,
                4.720705612724933244e-04,
                4.720705612724933244e-04,
                double.NaN,
                2.881966315335949824e-01,
                2.881966315335949824e-01,
                2.881966315335949824e-01,
                1.094257640377846409e-03,
                1.723129850379339972e-03,
                5.477118527838457408e-03,
                9.894835307521857026e-02,
                5.108892438066462427e-01,
                5.344507812333143537e-01,
                4.806728116588953048e-01,
                2.648542422095496833e-03,
                5.477118527838457408e-03,
                1.881396731606059525e-02,
                9.894835307521857026e-02,
                3.313410471111557509e-01,
                5.108892438066462427e-01,
                5.505977681639238064e-01,
                5.477118527838457408e-03,
                1.166401069979388326e-02,
                3.215902730219895311e-02,
                9.894835307521857026e-02,
                2.444628634438033576e-01,
                4.093230970723416018e-01,
                5.108892438066462427e-01,
                2.304817304740368539e-04,
                2.842851140551414229e-04,
                4.645046251551867016e-04,
                1.094257640377846409e-03,
                3.212955885897726682e-03,
                8.765239187082279546e-03,
                1.904909443435929065e-02,
                2.136338079717564143e-04,
                2.314657289637595070e-04,
                3.552341422887253519e-04,
                1.068281063441713389e-03,
                4.872643152533553783e-03,
                1.665743086645611951e-02,
                3.657501055378005461e-02,
                2.437914494046934286e-04,
                2.296006159922809708e-04,
                2.874310405449861439e-04,
                1.207704263485852476e-03,
                1.166401069979388326e-02,
                4.319891736828486428e-02,
                8.067939435168469675e-02,
                3.968849152606580247e-04,
                4.106015442127382092e-04,
                5.671067669549334283e-04,
                4.004677788407099912e-03,
                5.289802399831929069e-02,
                1.273533251320514148e-01,
                1.743390048960218874e-01,
                8.850373846885495463e-04,
                1.315647829386453914e-03,
                3.394244804784473258e-03,
                2.483954745792180813e-02,
                1.377391517828415735e-01,
                2.475366262490320823e-01,
                2.928908308705288621e-01,
                2.100598655844336266e-03,
                4.004677788407099912e-03,
                1.166401069979388326e-02,
                4.894917054073597007e-02,
                1.599918338402142315e-01,
                2.881966315335948714e-01,
                3.596313651672590206e-01,
                4.373156892909251317e-03,
                8.765239187082279546e-03,
                2.222385949607279948e-02,
                6.323238571210056114e-02,
                1.537213545536077475e-01,
                2.702548048008615589e-01,
                3.614372317405073476e-01,
                2.421612367728158324e-04,
                3.093033528300920504e-04,
                5.034106450212961744e-04,
                1.088184029928533679e-03,
                2.795292253273566185e-03,
                6.944466210818002645e-03,
                1.464983753323515631e-02,
                2.386602590246141985e-04,
                2.874310405449861439e-04,
                4.720705612724933244e-04,
                1.207704263485852476e-03,
                4.004677788407099912e-03,
                1.166401069979388326e-02,
                2.538992802317821193e-02,
                2.842851140551408808e-04,
                3.305573423587335256e-04,
                5.496121833220558818e-04,
                1.723129850379341490e-03,
                7.538870065694773005e-03,
                2.378855868810788449e-02,
                4.867081266568067111e-02,
                4.470928889462986869e-04,
                5.671067669549334283e-04,
                1.068281063441713389e-03,
                4.004677788407099912e-03,
                1.881396731606059525e-02,
                5.289802399831929069e-02,
                9.294483817292514827e-02,
                8.914370292058373165e-04,
                1.374951086871393667e-03,
                3.149364703866137233e-03,
                1.166401069979388326e-02,
                4.319891736828486428e-02,
                9.894835307521857026e-02,
                1.526177858307160573e-01,
                1.899399277901388499e-03,
                3.394244804784473258e-03,
                8.167474726182113662e-03,
                2.483954745792180813e-02,
                6.928647390159488328e-02,
                1.377391517828415735e-01,
                2.020680407801754841e-01,
                3.731843427296445501e-03,
                6.944466210818002645e-03,
                1.552144130937211861e-02,
                3.818745273637994680e-02,
                8.618602939930435081e-02,
                1.559168709680443243e-01,
                2.257623913634617119e-01,
                2.874310405449861439e-04,
                3.820097293533986343e-04,
                6.147370049117427447e-04,
                1.207704263485852476e-03,
                2.677741399547352210e-03,
                5.886988837062319749e-03,
                1.166401069979388326e-02,
                3.041511935197156150e-04,
                4.008567009142050388e-04,
                6.698946856546767869e-04,
                1.463762251667863811e-03,
                3.719729496861220747e-03,
                9.000018232611432106e-03,
                1.839999510236887612e-02,
                3.764115416382509045e-04,
                5.034106450212961744e-04,
                8.850373846885495463e-04,
                2.151573818902596715e-03,
                6.121760517292130534e-03,
                1.552144130937211861e-02,
                3.111005366066324149e-02,
                5.671067669549329946e-04,
                8.089732343092225723e-04,
                1.534397631049757432e-03,
                4.004677788407099912e-03,
                1.166401069979388326e-02,
                2.838915688939926130e-02,
                5.289802399831926988e-02,
                1.003958549100602334e-03,
                1.578552191731486150e-03,
                3.212955885897723646e-03,
                8.318204204321087009e-03,
                2.222385949607278907e-02,
                4.867081266568069192e-02,
                8.297621321510358083e-02,
                1.883513412633168157e-03,
                3.190254344691085143e-03,
                6.586878217466013083e-03,
                1.568975292398809909e-02,
                3.657501055378005461e-02,
                7.162745989628067911e-02,
                1.139454268340718418e-01,
                3.394244804784476294e-03,
                5.886988837062324953e-03,
                1.166401069979388326e-02,
                2.483954745792180813e-02,
                5.080742510382224575e-02,
                9.072187147263839624e-02,
                1.377391517828414902e-01,
            ];
            ddouble[] expected_dist_kappa1mum123 = [
                1.709056705719094182e-01,
                1.783872181340696583e-01,
                1.806054131389512041e-01,
                1.741997889648959630e-01,
                1.597622457002829954e-01,
                1.420295901781762349e-01,
                1.255250161135509079e-01,
                1.685068298354014116e-01,
                1.790378535392393722e-01,
                1.840654996165957957e-01,
                1.774902685072217434e-01,
                1.595623137241024281e-01,
                1.381466450651699096e-01,
                1.197126817107961316e-01,
                1.597622457002830509e-01,
                1.713765357206374351e-01,
                1.780882523729716560e-01,
                1.715648536716459227e-01,
                1.515801661443744730e-01,
                1.287855751599646381e-01,
                1.105870664116048174e-01,
                1.442027962971669242e-01,
                1.530348875755798421e-01,
                1.576608055718828061e-01,
                1.509691326193447758e-01,
                1.331418464052336881e-01,
                1.137685580372796157e-01,
                9.881566486497984914e-02,
                1.250146599376271705e-01,
                1.287855751599646381e-01,
                1.290177564336821570e-01,
                1.223516956436293962e-01,
                1.098137170487505088e-01,
                9.677943540835402814e-02,
                8.653486585862429914e-02,
                1.068188037688895115e-01,
                1.065947516991390537e-01,
                1.039451232699039329e-01,
                9.809303143942516012e-02,
                9.010773014948801618e-02,
                8.224912797875714998e-02,
                7.588752021982753115e-02,
                9.219430588569951790e-02,
                9.003451633051287595e-02,
                8.653486585862429914e-02,
                8.179972706146790284e-02,
                7.654811813591716474e-02,
                7.168431454938867242e-02,
                6.771391313789559829e-02,
                1.591736896745402363e-01,
                1.678006861996312049e-01,
                1.713765357206374351e-01,
                1.648095970711722646e-01,
                1.485625313519681745e-01,
                1.294759816422388909e-01,
                1.130821181987367169e-01,
                1.572688106590597046e-01,
                1.709056705719094460e-01,
                1.804131606285199196e-01,
                1.741997889648959630e-01,
                1.509691326193447758e-01,
                1.255250161135509079e-01,
                1.065947516991390537e-01,
                1.485625313519681745e-01,
                1.650358093663377435e-01,
                1.807784370069838720e-01,
                1.761744254407185128e-01,
                1.453368695669544353e-01,
                1.155628056769865825e-01,
                9.677943540835402814e-02,
                1.319490753619399770e-01,
                1.442027962971668964e-01,
                1.563272704061205998e-01,
                1.509691326193447758e-01,
                1.230887912604907153e-01,
                9.881566486497984914e-02,
                8.457734705421020294e-02,
                1.116413689127893211e-01,
                1.155628056769865825e-01,
                1.168436125748000820e-01,
                1.092220661835852369e-01,
                9.393645150200873040e-02,
                8.092038998816782069e-02,
                7.272754814602434836e-02,
                9.363399689411068538e-02,
                9.219430588569951790e-02,
                8.846021583504630470e-02,
                8.179972706146790284e-02,
                7.402321432323395733e-02,
                6.771391313789559829e-02,
                6.346390366722542975e-02,
                8.033718061357739137e-02,
                7.708682740173659897e-02,
                7.272754814602437612e-02,
                6.771391313789559829e-02,
                6.304590419080582930e-02,
                5.948064263367486282e-02,
                5.707412181292744607e-02,
                1.413245301322191283e-01,
                1.485625313519681745e-01,
                1.515801661443744730e-01,
                1.448835765695236921e-01,
                1.290177564336821570e-01,
                1.116413689127893211e-01,
                9.782452124915815006e-02,
                1.383210434004294997e-01,
                1.509691326193447758e-01,
                1.620918632128149073e-01,
                1.563272704061205998e-01,
                1.303137938996308809e-01,
                1.057129152945584516e-01,
                9.010773014948801618e-02,
                1.290177564336820737e-01,
                1.453368695669544353e-01,
                1.709056705719094460e-01,
                1.741997889648959630e-01,
                1.255250161135509079e-01,
                9.393645150200873040e-02,
                7.955560914596987443e-02,
                1.124360058918550676e-01,
                1.230887912604907153e-01,
                1.442027962971668964e-01,
                1.509691326193447758e-01,
                9.881566486497984914e-02,
                7.631080431725117963e-02,
                6.771391313789559829e-02,
                9.346816116944058062e-02,
                9.393645150200873040e-02,
                9.219430588569951790e-02,
                8.179972706146790284e-02,
                6.771391313789559829e-02,
                6.071451068872877471e-02,
                5.763483029881049519e-02,
                7.811239986324429452e-02,
                7.402321432323395733e-02,
                6.771391313789559829e-02,
                6.008551572047741984e-02,
                5.443861737343276552e-02,
                5.183317708603089186e-02,
                5.088546814840082949e-02,
                6.771391313789559829e-02,
                6.304590419080582930e-02,
                5.763483029881049519e-02,
                5.254896460179249440e-02,
                4.905599912396257228e-02,
                4.737756542079057942e-02,
                4.687141806468005795e-02,
                1.193712494342494407e-01,
                1.225220634754420196e-01,
                1.223516956436293962e-01,
                1.155628056769865825e-01,
                1.033239086259570422e-01,
                9.108484156901087980e-02,
                8.179972706146790284e-02,
                1.137685580372796157e-01,
                1.193712494342494407e-01,
                1.230887912604907153e-01,
                1.155628056769865825e-01,
                9.691751474076439055e-02,
                8.179972706146790284e-02,
                7.292391243047345595e-02,
                1.033239086259570422e-01,
                1.092220661835852369e-01,
                1.193712494342494407e-01,
                1.155628056769865825e-01,
                8.179972706146790284e-02,
                6.771391313789559829e-02,
                6.222620697230533959e-02,
                8.846021583504630470e-02,
                8.846021583504630470e-02,
                8.846021583504630470e-02,
                double.NaN,
                5.183317708603089186e-02,
                5.183317708603089186e-02,
                5.183317708603089186e-02,
                7.368557807946042593e-02,
                6.771391313789559829e-02,
                5.605365931112421540e-02,
                3.967690127966121832e-02,
                3.841104163839733493e-02,
                4.198029018000362655e-02,
                4.437669938566940475e-02,
                6.287613869892171026e-02,
                5.605365931112421540e-02,
                4.731006613934461008e-02,
                3.967690127966121832e-02,
                3.725094694238197113e-02,
                3.841104163839733493e-02,
                4.030264698392329453e-02,
                5.605365931112421540e-02,
                5.033959496951520562e-02,
                4.437669938566940475e-02,
                3.967690127966121832e-02,
                3.747536156590413475e-02,
                3.742325179958717191e-02,
                3.841104163839733493e-02,
                9.782452124915815006e-02,
                9.677943540835402814e-02,
                9.346816116944058062e-02,
                8.725526881818077007e-02,
                7.955560914596987443e-02,
                7.272754814602434836e-02,
                6.771391313789559829e-02,
                9.010773014948801618e-02,
                8.846021583504630470e-02,
                8.422649680820393225e-02,
                7.631080431725113800e-02,
                6.771391313789559829e-02,
                6.194237948685379913e-02,
                5.869969480484516638e-02,
                7.955560914596987443e-02,
                7.552023363827710389e-02,
                6.771391313789559829e-02,
                5.605365931112421540e-02,
                4.973380935402960806e-02,
                4.881144602687510076e-02,
                4.905599912396257228e-02,
                6.771391313789559829e-02,
                6.008551572047739209e-02,
                4.640128707034029548e-02,
                3.037159949780977863e-02,
                3.179670679199271544e-02,
                3.725094694238197113e-02,
                4.078029983434890149e-02,
                5.763483029881049519e-02,
                4.881144602687510076e-02,
                3.652797007648805883e-02,
                2.632135239480947603e-02,
                2.682868284652516894e-02,
                3.154859497186397743e-02,
                3.553909290620278077e-02,
                5.088546814840082949e-02,
                4.337383014809818860e-02,
                3.518563841352068122e-02,
                2.933060892405211714e-02,
                2.828750278739450286e-02,
                3.037159949780977863e-02,
                3.314878141262077305e-02,
                4.687141806468005795e-02,
                4.107056440725177088e-02,
                3.553909290620276690e-02,
                3.164730013581788792e-02,
                3.024916880008735043e-02,
                3.086359656583574987e-02,
                3.244428994850868248e-02,
                8.033718061357739137e-02,
                7.708682740173659897e-02,
                7.272754814602434836e-02,
                6.771391313789559829e-02,
                6.304590419080580155e-02,
                5.948064263367486282e-02,
                5.707412181292744607e-02,
                7.224853448172594006e-02,
                6.771391313789559829e-02,
                6.194237948685379913e-02,
                5.605365931112421540e-02,
                5.183317708603089186e-02,
                4.973380935402960806e-02,
                4.896911575431064922e-02,
                6.304590419080582930e-02,
                5.666277724460935111e-02,
                4.881144602687510076e-02,
                4.198029018000362655e-02,
                3.924197422012407066e-02,
                3.967690127966121832e-02,
                4.107056440725177088e-02,
                5.421279092033452762e-02,
                4.640128707034029548e-02,
                3.725094694238197113e-02,
                3.037159949780977863e-02,
                2.933060892405211714e-02,
                3.179670679199271544e-02,
                3.474957304451894990e-02,
                4.737756542079057942e-02,
                3.967690127966121832e-02,
                3.154859497186397743e-02,
                2.602633169358256268e-02,
                2.536350080440918572e-02,
                2.778290390462195836e-02,
                3.086359656583574987e-02,
                4.301500739349724961e-02,
                3.652797007648805883e-02,
                3.037159949780977863e-02,
                2.632135239480947603e-02,
                2.541485342018691418e-02,
                2.682868284652516894e-02,
                2.915501181214238263e-02,
                4.054729523538136426e-02,
                3.541331739129792433e-02,
                3.086359656583574987e-02,
                2.782103781533052170e-02,
                2.675496976972860375e-02,
                2.732512086983674912e-02,
                2.880610509074518766e-02,
                6.771391313789559829e-02,
                6.396342158349579976e-02,
                5.989923912048543408e-02,
                5.605365931112421540e-02,
                5.298643485433333217e-02,
                5.092684693961692377e-02,
                4.973380935402960806e-02,
                6.042065967058016240e-02,
                5.574738778544501006e-02,
                5.088546814840082949e-02,
                4.674311686735796445e-02,
                4.411148775629045865e-02,
                4.301500739349724961e-02,
                4.292478356495020575e-02,
                5.298643485433333217e-02,
                4.737756542079057942e-02,
                4.175411010275643237e-02,
                3.747536156590413475e-02,
                3.553909290620276690e-02,
                3.560316461491298129e-02,
                3.667709078866529526e-02,
                4.640128707034029548e-02,
                4.030264698392329453e-02,
                3.443826382346332204e-02,
                3.037159949780977863e-02,
                2.908252317888821228e-02,
                2.996162577753373052e-02,
                3.179670679199271544e-02,
                4.146211832205098924e-02,
                3.560316461491298129e-02,
                3.024916880008735043e-02,
                2.672560221000700939e-02,
                2.574663949671257904e-02,
                2.675496976972860375e-02,
                2.869998485780139719e-02,
                3.830148959091408956e-02,
                3.319062891670977733e-02,
                2.873594601025055914e-02,
                2.583338270323202318e-02,
                2.491055652470061665e-02,
                2.561008156546931702e-02,
                2.721061239431836476e-02,
                3.652797007648805883e-02,
                3.228323074575068646e-02,
                2.869998485780141106e-02,
                2.632135239480947603e-02,
                2.538779958338681711e-02,
                2.570348974779353840e-02,
                2.682868284652517935e-02,
            ];

            foreach ((VonMisesFisherDistribution dist, ddouble[] expecteds) in new[]{
                (dist_kappa0mup100,  expected_dist_kappa0mup100),
                (dist_kappa1mu123,   expected_dist_kappa1mu123),
                (dist_kappa2mu231,   expected_dist_kappa2mu231),
                (dist_kappa4mu312,   expected_dist_kappa4mu312),
                (dist_kappa4mu321,   expected_dist_kappa4mu321),
                (dist_kappa1mum123,  expected_dist_kappa1mum123),
            }) {
                for (int z = -3, i = 0; z <= 3; z++) {
                    for (int y = -3; y <= 3; y++) {
                        for (int x = -3; x <= 3; x++, i++) {
                            ddouble expected = expecteds[i];
                            ddouble actual = dist.PDF((x, y, z));

                            Console.WriteLine($"{dist} pdf({x},{y},{z})");
                            Console.WriteLine(expected);
                            Console.WriteLine(actual);

                            if (x == 0 && y == 0 && z == 0) {
                                Assert.IsTrue(ddouble.IsNaN(actual));
                                continue;
                            }

                            if (expected > 0) {
                                Assert.IsTrue(ddouble.Abs(expected - actual) / expected < 1e-10, $"{dist} pdf({x},{y},{z})\n{expected}\n{actual}");
                            }
                            else {
                                Assert.AreEqual(0, actual);
                            }
                        }
                    }
                }
            }
        }

        [TestMethod()]
        public void InverseKappaBp5Test() {
            for (double x = 0; x <= 1; x += 1d / 4096) {
                double y = InverseKappaBp5.Value(x);
                ddouble z = ddouble.BesselI(1.5, y) / ddouble.BesselI(0.5, y);

                ddouble err = ddouble.Abs(x - z);

                Console.WriteLine($"{x},{y},{z},{err:e2}");

                if (x > 0 && x < 0.998) {
                    Assert.AreEqual(x, (double)z, 5e-16);
                }
            }
        }
    }
}